<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Response with headers" href="headers.html" /><link rel="prev" title="Changelog" href="changelog.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.07.26 -->
        <title>Creating APIs - mock documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">mock  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">mock  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#">Creating APIs</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Creating APIs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="headers.html">Response with headers</a></li>
<li class="toctree-l2"><a class="reference internal" href="route_params.html">Route Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell_scripts.html">Responses from Shell scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="static_files.html">Serving static files</a></li>
<li class="toctree-l2"><a class="reference internal" href="status_codes.html">Response Status Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="conditional_responses.html">Conditional Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="env_vars.html">Reading Environment Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="middlewares.html">Middlewares</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="test_assertions.html">Test Assertions</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Test Assertions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="assertion_chaining.html">Assertion Chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="mock_package.html">Test Assertions with <em>mock</em>’s Go package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api_reference.html">Mock API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmd_reference.html">Command-line Options Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditions_reference.html">Conditions Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Miscellaneous:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cors.html">Handling CORS</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="creating-apis">
<h1>Creating APIs<a class="headerlink" href="#creating-apis" title="Permalink to this heading">#</a></h1>
<p>The simplest endpoint configuration we can define looks like this:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;endpoints&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;route&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;foo/bar&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;method&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;response&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;foo&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;bar&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">POST</span></code> HTTP Request to <code class="docutils literal notranslate"><span class="pre">/foo/bar</span></code> will respond you with
<code class="docutils literal notranslate"><span class="pre">{&quot;foo&quot;:&quot;bar&quot;}</span></code>, as can be seen in the <code class="docutils literal notranslate"><span class="pre">response</span></code> endpoint
configuration parameter above.</p>
<p>Endpoint Routes can also be set with wildcards:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>{
<span class="w"> </span>  &quot;endpoints&quot;: [
<span class="w"> </span>    {
<span class="gi">+      &quot;route&quot;: &quot;foo/bar/*&quot;,</span>
<span class="w"> </span>      &quot;method&quot;: &quot;POST&quot;,
<span class="w"> </span>      &quot;response&quot;: {
<span class="w"> </span>        &quot;foo&quot;: &quot;bar&quot;
<span class="w"> </span>      }
<span class="w"> </span>    }
<span class="w"> </span>  ]
<span class="w"> </span>}
</pre></div>
</div>
<p>With the configuration above, requests such as <code class="docutils literal notranslate"><span class="pre">foo/bar/anything</span></code> and
<code class="docutils literal notranslate"><span class="pre">/foo/bar/hello/world</span></code> will be responded by the same Endpoint.</p>
<p>Besides wildcards, routes can have placeholder variables as well, such
as <code class="docutils literal notranslate"><span class="pre">foo/bar/{some_variable}</span></code>. In order to read that variable and do
something useful with it, you will need to <a class="reference external" href="#responses-from-shell-scripts">define shell scripts that
act as handlers for your Endpoints.</a></p>
<p>In the next sections we’ll look at other ways of setting up endpoints.</p>
<section id="endpoints-defined-through-command-line-parameters">
<h2>Endpoints defined through command-line parameters<a class="headerlink" href="#endpoints-defined-through-command-line-parameters" title="Permalink to this heading">#</a></h2>
<p>An alternative for creating configuration file exists - endpoints can be
defined all through command-line parameters. Let’s start up mock with
two endpoints, <code class="docutils literal notranslate"><span class="pre">hello/world</span></code> and <code class="docutils literal notranslate"><span class="pre">hello/world/again</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mock<span class="w"> </span>serve<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--route<span class="w"> </span><span class="s1">&#39;hello/world&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--method<span class="w"> </span>GET<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--response<span class="w"> </span><span class="s1">&#39;Hello world!&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--route<span class="w"> </span><span class="s1">&#39;hello/world/again&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--method<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--response<span class="w"> </span><span class="s1">&#39;Hello world! This is another endpoint.&#39;</span>
</pre></div>
</div>
<p>As shown above, all which can be accomplished through JSON configuration
files can be done through command-line parameters, it’s just a matter of
preference. As we move forward through this manual learning more
advanced functionality, you’ll be instructed on how to achieve things in
both ways - the above only scratches the surface. A few notes to be
aware while using command line parameters:</p>
<ul class="simple">
<li><p>Both configuration file and command-line parameters can be used
together, but when routes are defined as parameters which have been
already defined in the configuration file, the former will overwrite
the latter. In other words, command-line parameters defined endpoints
always overwrite the ones defined in config (which have the same
route and method combination).</p></li>
</ul>
</section>
<section id="file-based-response-content">
<h2>File-based response content<a class="headerlink" href="#file-based-response-content" title="Permalink to this heading">#</a></h2>
<p>In the earlier example, <code class="docutils literal notranslate"><span class="pre">response</span></code> is a JSON object containing the
response JSON that you’ll be responded with. However, as you setup
complex APIs, your configuration file starts getting large and not
easily readable. In the following example, we’re setting the response
content by referencing a file, thus leaving the configuration file more
readable:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="w"> </span> {
<span class="w"> </span>   &quot;endpoints&quot;: [
<span class="w"> </span>     {
<span class="w"> </span>       &quot;route&quot;: &quot;foo/bar&quot;,
<span class="w"> </span>       &quot;method&quot;: &quot;POST&quot;,
<span class="gi">+       &quot;response&quot;: &quot;file:path/to/some/file.json&quot;</span>
<span class="w"> </span>     }
<span class="w"> </span>   ]
<span class="w"> </span> }
</pre></div>
</div>
<p>To define responses referenced by files using command-line parameters,
<code class="docutils literal notranslate"><span class="pre">--response-file</span></code> can be used:</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>$ mock serve \
<span class="w"> </span>  --route &quot;foo/bar&quot; \
<span class="w"> </span>  --method &quot;POST&quot; \
<span class="gi">+  --response-file path/to/some/file.json</span>
</pre></div>
</div>
<p>The above can also be accomplished with
<code class="docutils literal notranslate"><span class="pre">--response</span> <span class="pre">&quot;file:path/to/some/file.json&quot;</span></code>.</p>
<div class="toctree-wrapper compound">
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="headers.html">Response with headers</a></li>
<li class="toctree-l1"><a class="reference internal" href="route_params.html">Route Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="shell_scripts.html">Responses from Shell scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="shell_scripts.html#environment-variables-for-request-handlers">Environment Variables for Request Handlers</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell_scripts.html#route-parameters-reading-from-shell-scripts">Route Parameters - Reading from Shell Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell_scripts.html#response-files-that-can-be-written-to-by-shell-scripts">Response Files that can be written to by shell scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="static_files.html">Serving static files</a></li>
<li class="toctree-l1"><a class="reference internal" href="status_codes.html">Response Status Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional_responses.html">Conditional Response</a><ul>
<li class="toctree-l2"><a class="reference internal" href="conditional_responses.html#condition-chaining">Condition Chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="conditional_responses.html#headers-in-conditional-responses">Headers in Conditional Responses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="env_vars.html">Reading Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="middlewares.html">Middlewares</a><ul>
<li class="toctree-l2"><a class="reference internal" href="middlewares.html#setting-up-middlewares">Setting up Middlewares</a></li>
<li class="toctree-l2"><a class="reference internal" href="middlewares.html#examples-of-middlewares">Examples of Middlewares</a></li>
<li class="toctree-l2"><a class="reference internal" href="middlewares.html#environment-variables-for-middlewares">Environment Variables for Middlewares</a></li>
<li class="toctree-l2"><a class="reference internal" href="middlewares.html#conditions-for-middlewares">Conditions for Middlewares</a></li>
</ul>
</li>
</ul>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="headers.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Response with headers</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="changelog.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Changelog</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, Dhuan Oliveira
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Creating APIs</a><ul>
<li><a class="reference internal" href="#endpoints-defined-through-command-line-parameters">Endpoints defined through command-line parameters</a></li>
<li><a class="reference internal" href="#file-based-response-content">File-based response content</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=b3ba4146"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>